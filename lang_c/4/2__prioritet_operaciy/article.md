# Приоритет операций. Cложные математические выражения

В математических вычислениях важную роль играет порядок, в котором выполняются действия. Вспомним старый школьный прикол. Сколько будет `2 + 2 * 2`?  Конечно же шесть, т.к. сначала выполняется умножение.

В C используется знакомый нам со школы порядок действий. Но т.к. в программировании есть свои особенности, то кое-какие отличия всё же есть. 

Выпишем приоритет для тех операций, которые мы уже знаем.

1. явное приведение типов
2. вызов и вычисление функций (например, `sqrt()`, `cos()` и пр.)
3. умножение, деление, остаток от деления
4. сложение, вычитание
5. выполняется присваивание


Давайте себя проверим. Какое значение будет записано в переменную `x` после выполнения следующей строки кода `int x = 8 / 4 * 2;`?

Правильный ответ `4`. Т.к  все операторы `/` и `*`, присутствующие в выражении, имеют одинаковыq приоритет, то действия выполняются слева направо. Другими словами данный код эквивалентен коду `int x = (8 / 4) * 2;` 

Здесь я использовал =круглые группирующие скобки `()`= для того, чтобы явно указать, что деление должно быть выполнено первым действием. Использование скобок для изменения порядка действий скорее всего уже хорошо вам известно со школы.

Давайте дополним нашу таблицу приоритетов операций скобками:

1. действия в скобках `()`
2. явное приведение типов
3. вызов и вычисление функций (например, `sqrt()`, `cos()` и пр.)
4. умножение, деление, остаток от деления
5. сложение, вычитание
6. выполнение присваивания

Листинг 1.
```c
2 + 2 * 2 = 6  // эквивалентно выражению 2 + (2 * 2)
(2 + 2) * 2 = 8 // действие в скобках будет выполнено прежде умножения
```

% **Важно!**
Если в вашей программе вы написали довольно сложное выражение, в котором не сразу ясен порядок операций, то лучше добавить лишние скобки, чтобы явно задать последовательность операций. Это поможет избежать ошибок в вычислениях, которые потом будет сложно отловить.

Кстати, а чему равняется значение `x` для следующего выражения: `int x = 1 / 2 * 2 + 1`? 

Кто сказал `2`? Не правильно! Уже догадались почему? Нет, с приоритетами тут всё хорошо. Если расставить скобки, то получим следующее эквивалентное выражение `int x = ((1 / 2) * 2) + 1`.

Да, верно, проблема в том, что деление-то целочисленное, а значит `1 / 2` даст `0`, а значит `0 * 2 = 0`. И в итоге правильный ответ `1`. Вывод: Не забывайте про особенности целочисленного деления.


## Сложные математические выражения

Формулы для вычислений бывают довольно громоздкими.

При этом, когда мы пишем программу, любое выражение, даже если в нём присутствуют дроби (в том числе и многоуровневые), мы записываем в строчку. На начальном этапе это может вызвать некоторые затруднения. Чтобы от них избавиться, нужно овладеть навыком переводить формулу из стандартной математической записи в ту, которая используется в программировании и обратно.

В следующем небольшом видео на простом примере показаны несколько подходов, позволяющих не запутаться при записи сложных математических выражений.

<div class="lessonVideo">
    <iframe src="https://www.youtube.com/embed/Gx6KUtmRmHs"  allowfullscreen></iframe>
</div>

Зеркало <a href="https://rutube.ru/video/5c9aa7607179e9bfa948a5e0951baf40/?r=wd">на RuTube</a>, <a href="https://vkvideo.ru/video-31218664_456239034">на VK.Видео</a>