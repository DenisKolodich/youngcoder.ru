# Структура программ на языке Си

Я надеюсь, вы уже установили себе на компьютер какую-нибудь IDE и научились в ней компилировать программы. Если нет, то обязательно сделайте это. Для этого прочитайте один из следующих уроков:

1. [IDE Pelles C](../ide/1/)
2. [IDE Code::Blocks](../ide/2/)

% **Важно!**
Прежде чем продолжить чтение, установите IDE!

Все программы, написанные на языке Си, имеют общую структуру, которую мы и обсудим в этом уроке. В этом нам будет ваша первая программа, написанная при установке IDE (она же Листинг 1 в этом уроке).

Для наглядности будем составлять карту со структурой программ. На данный момент мы знаем, что существуют программы, но как они устроены внутри нам неизвестно. Поэтому наша карта будет иметь следующий вид.
		
![Рисунок карты со структурой программы. Изображён пустой прямоугольный блок, т.к. мы ничего не знаем о том, как программы устроены внутри.](./structura_programmy0.png "Рис.1 Начальное состояние карты со структурой программы")
			
На протяжении курса мы к этой карте будем возвращаться, уточнять её, дополнять новыми элементами и блоками.

			
Сейчас внимание. Не пугайтесь! Ниже написан исходный код трёх простеньких программ. Ваша задача внимательно на них посмотреть и попытаться найти в их коде какую-то закономерность (нечто общее, что есть в каждой программе).

Листинг 1. 
```c
// комментарий
#include <stdio.h>

int main(void) {
  printf("Hello, World!\n");
  
  return 0;
}
 ```

Листинг 2. 
```c
int main(void) {
  int a, b, c;
  
  a = 5;
  b = 10;
  c = a + b;
  
  return 0;
}
```

Листинг 3.
```c
#include <stdio.h>

int main(void) {
  FILE *fp;
	
  fp = fopen("input.txt", "w");
  fprintf(fp, "This is Sparta!");
  fclose(fp);
	
  return 0;
}
```

Не торопитесь смотреть продолжение урока и правильный ответ на эту задачу. Для начала подумайте и попробуйте ответить самостоятельно. 

![Картинка с мемом Think about it.](./think_about_it.png)

Итак, ответ: Во всех программах выше присутствует следующая конструкция:

Листинг 4. Главная функция любой программы на языке Си -- функция `main`.
```c
int main(void) {

  return 0;
}
```

Что же это за конструкция? Это =определение функции= с именем `main`. Такая функция обязательно есть в каждой программе, которая написана на языке Си. Большая программа или маленькая, компьютерная игра или программа «Hello, World», написана вами или Брайном Керниганом -- если программа написана на языке Си -- в ней есть функция `main`. Это главная функция нашей программы. Когда мы запускаем программу, то можно думать, что запускаем функцию `main` этой программы.

			
Остановимся на секундочку. Мы, кажется, уже кое-что выяснили о структуре программ на языке Си. Любая программа, написанная на Си, должна содержать функцию `main`. Отобразим этот факт на нашей карте знаний "Структура программ на языке Си."
						
![Карта "Структура программ на языке Си." На рисунок добавлен блок с функцией main](./structura_programmy1.png "Рис.2 Карта "Структура программ на языке Си." Функция main")

Теперь карта не напрягает нас своей зияющей пустотой. Продолжим наши исследования.
	
Давайте я расскажу немного о функции `main` и о функциях вообще.
			
Перед именем функции написано `int`, это сокращение от слова integer, которое переводится с английского, как "целое". Подобная запись означает, что когда функция `main` завершит свою работу, она должна вернуть вызывающей программе (в нашем случае это операционная система) какое-нибудь целое число. Обычно, для функции `main` это число ноль, которое оповещает операционную систему: "Мол, всё хорошо. Происшествий не случилось."

			
Случалось ли вам видеть сообщения об ошибках на экране своего компьютера? Обычно там написано что-то вроде "Программа аварийно завершена ... бла-бла-бла... Код -314." Вот это примерно тоже самое. Разница в том, что когда случаются проблемы операционная система нас об этом оповещает, а когда всё хорошо она нас лишний раз не беспокоит.


После имени функции в круглых скобках записано слово `void`. Вообще, в скобках обычно записывают =параметры функции=. Но в нашем случае, когда в скобках написано `void`, это означает, что параметров у функции нет. Другими словами, чтобы функция `main` начала работу, ей не нужны никакие дополнительные данные извне. Мы ещё поговорим обо всём этом подробно, а пока просто запомним, что слово `void` вместо параметров функции обозначает, что для работы данной функции никаких параметров не требуется.


Внутри фигурных скобок идёт описание функции `main`, т.е. непосредственно то, что и как эта функция должна делать.
			
			
Перед закрывающей фигурной скобкой мы видим инструцию `return`. Эта инструкция (иногда ещё говорят команда) отвечает за то, чтобы вернуть значение из функции. Т.е. смотрите, если программа дошла до этого места, то значит, всё было хорошо и никаких ошибок не возникло, а значит, можно вернуть значение нуль.

Вы можете спросить, а почему именно нуль? А чёрт его знает! Просто так обычно делают. Можно, в принципе, возвращать какое-нибудь другое целое число, например `100`, или `-236`. Лишь бы оно было целым числом. Помните про `int`? Поэтому и целое.
			
Вот мы и разобрались с функцией `main`. Ещё один момент. То, что записано в фигурных скобках обычно называют =телом функции= (или описанием функции). А первая часть, та, что перед фигурными скобками, называется =заголовок функции=.
	
Вернёмся теперь к нашей первой программе «Hello, World» и посмотрим, что там к чему.
			
			
Листинг 5. Программа «Hello, World»
```c
#include <stdio.h>

int main(void) {
  printf("Hello, World!\n");

  return 0;
}
```			

Кое-что нам теперь уже понятно в этой программе. Не ясными остаются только две строки, пойдём по порядку.


Листинг 6. Директива include
```c
#include <stdio.h>
```	

Данная строчка -- это сообщение компилятору, которое буквально означает «подключи файл stdio.h». Такие сообщения, начинающиеся с символа `#`, называются =директивами=. Во время компиляции вместо этой строчки вставится содержимое файла `stdio.h`. Теперь немного поговорим об этом файле. `stdio.h` (от англ. STanDart Input Output) это =заголовочный файл=, в нем описаны различные стандартные функции, связанные с вводом и выводом.

Возникают резонные вопросы "А зачем нам писать эту строчку? Зачем нам вообще понадобилось вставлять сюда этот файл?". Это нужно для того, чтобы в своей программе мы могли использовать стандартную функцию вывода на экран `printf()`.

 
Дело вот в чем. Прежде чем использовать что-нибудь в своей программе, нам надо сначала это описать. Представьте ситуацию: вас попросили принести канделябр, а вы знать не знаете, что это такое. Непонятно, что делать.


Так же и компилятор. Когда он встречает какую-нибудь функцию, он ищет её определение (описание) (т.е. что она должна делать и что обозначает) в начале программы (с самого начала и до момента её использования в программе). Так вот, функция `printf()` описана в файле `stdio.h`. Поэтому мы и подключаем его. И вот когда мы его подключим с помощью директивы `#include`, компилятор сможет найти функцию `printf()`, иначе он выдаст ошибку.

			
Кстати, дополним нашу карту знаний. Перед функцией `main` добавим ещё один блок -- блок подключения заголовочных файлов.

![](./structura_programmy3.png "Рис.3 Карта "Структура программ на языке Си." Блок подключения заголовочных файлов")
			

Продолжим разбираться с нашей программой.
			
Листинг 7. Функция `printf()`
```c
printf("Hello, World!\n");
```

В этой строке мы вызываем стандартную функцию вывода на экран `printf()`. В данном простейшем случае мы передаем ей один аргумент -- записанную в кавычках строку, которую надо вывести на экран. В нашем случае это `Hello, World!\n`. Но постойте, а что это за `\n`? На экране во время запуска программы никаких `\n` не было. Зачем тогда мы тут это написали? На самом деле он тоже был, просто вы его незаметили. Запись `\n` -- это специальный способ для записи символа переноса строки. Это как в Wordе нажать клавишу `Enter`. Есть и другие последовательности, начинающиеся с символа `\`, мы познакомимся с ними чуть позже. Пока ли скажу, что их называют =escape-последовательностями= или =управляющими последовательностями=, т.к. они управляют выводом. В остальном на экране появится именно то, что вы написали в двойных кавычках.


% **Важно!** Обратите внимание, каждая инструкция языка Си заканчивается символом `;` (точкой с запятой).

Это похоже на точку в конце предложения в русском языке. В обычном языке мы разделяем точкой предложения, а в языке программирования Си точкой с запятой отделяем инструкции друг от друга. Поэтому ставить точку с запятой обязательно. Иначе компилятор будет ругаться и выдаст ошибку.

Чтобы вызвать какую-нибудь функцию, необходимо написать её имя и указать передаваемые ей аргументы в круглых скобках. Количество передаваемых аргументов зависит от количества параметров, указанных в объявлении функции. У функции может быть один или несколько параметров, а может не быть параметров вовсе (как у функции main, помните?). Например, выше мы вызвали функцию `printf()` и передали ей в качестве параметров один аргумент - строку, которую необходимо вывести на экран.

Кстати, полезный совет. Так как в каждой программе обязательно присутствует функция `main`, и буквально в каждой программе нам потребуется что-то выводить на экран, то рекомендую вам сразу создать файл со следующей заготовкой, чтобы каждый раз не писать одно и то же.


Листинг 8. Стандартная заготовка для программ на языке Си.</p>
```c
#include <stdio.h>

int main(void) {
  
  return 0;
}
```

% Пустые строки, пробелы и переносы строк в коде программы на Си **чаще всего** ни на что не влияют и ничего не обозначают. Но мы их всё равно добавляем, чтобы сделать код более читаемым и понятным.

Например, наша первая программа могла бы выглядеть вот так:
Листинг 9. Программа "Hello, World!" в стиле В.В. Маяковского
```c
#include <stdio.h> 
int
        main
                (
void
        )
                {
printf
        (
                "Hello, World!\n"
)
        ;
                return
0
        ;
                }
```
или так:

Листинг 10. "Hello, World!" в две строки
```c
#include<stdio.h> 
int main(void){printf("Hello, World!\n");return 0;}
```

и даже вот так:

Листинг 11. "Hello, World!", записанная ромбиком
```c
#include<stdio.h> 
       int 
      main(
     void) {
    printf  (
"Hello, World!\n"
    );return
       0;}
```

Думаю, эти примеры наглядно показывают, что грамотное использование пробелов, переносов и пустых строк очень сильно повышают читаемость вашего кода. =)

Ну вот вроде бы и всё. На этом первый урок можно считать законченным. Хотя нет, ещё один момент есть.


Самое главное в этом уроке это, конечно, общая структура программы. Но кроме того, мы научились выводить на экран произвольный текст. Кажется, что совсем ничего вроде и не узнали, но даже этого хватит для того, чтобы, например, сделать небольшой подарок своей маме на 8 марта.

![Программа-открытка на 8 марта](./otkritka.gif)